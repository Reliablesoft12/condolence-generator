<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Condolence Letter Generator</title>

  <!-- Calibri-compatible font -->
  <link href="https://fonts.googleapis.com/css2?family=Carlito:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --page-width:210mm;   /* A4 width */
      --page-height:297mm;  /* A4 height */
    }

    body {
      margin:0;
      font-family:'Carlito', Calibri, sans-serif;
      background:#f7f9fb;
      padding:20px;
    }
    .container {
      display:grid;
      grid-template-columns:400px 1fr;
      gap:20px;
      max-width:1100px;
      margin:0 auto;
    }
    .card {
      background:#fff;
      padding:16px;
      border-radius:8px;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    h1 {margin:0 0 12px 0;font-size:18px;font-weight:600}
    label{display:block;margin-top:10px;font-size:13px;color:#444}
    input,select,textarea{
      width:100%;
      padding:8px 10px;
      font-family:'Carlito', Calibri, sans-serif;
      font-size:14px;
      border:1px solid #ccc;
      border-radius:6px;
    }
    textarea{min-height:60px;resize:vertical}
    .btn{margin-top:14px;padding:10px 14px;border:none;border-radius:6px;cursor:pointer;font-weight:600}
    .btn-primary{background:#0b75d6;color:#fff}
    .preview-frame{background:#fff;border:1px solid #ddd;border-radius:8px;padding:12px;overflow:auto}

    /* Printable letter */
    .page {
      width:var(--page-width);
      min-height:var(--page-height);
      padding:25.4mm; /* 1 inch margins all around */
      background:#fff;
      font-size:12pt;
      font-family:'Carlito', Calibri, sans-serif;
      line-height:1.5;
      color:#000;
    }
    .meta{text-align:right;margin-bottom:12mm}
    .to{margin-bottom:14mm}
    .to .recipient{font-weight:bold}
    .body-paragraph{margin:8mm 0;text-align:justify}
    .signatures{display:flex;justify-content:space-between;margin-top:20mm}
    .sig-block{font-weight:bold}
    .sig-title{font-weight:400;font-size:11pt}
  </style>
</head>
<body>
  <div class="container">
    <!-- Left: form -->
    <div class="card">
      <h1>Condolence Letter Generator</h1>
      <label>Date</label>
      <input id="date" type="text" placeholder="e.g., 10 September 2025" />

      <label>Recipient / Member name</label>
      <input id="member" type="text" placeholder="e.g., Rajneesh Parek" />

      <label>Deceased person name</label>
      <input id="deceased" type="text" placeholder="e.g., Madhubala Pareek" />

      <label>Relation</label>
      <input id="relation" type="text" placeholder="e.g., mother" />

      <label>Gender</label>
      <select id="gender">
        <option value="female">Female (she/her)</option>
        <option value="male">Male (he/his)</option>
        <option value="other">Other (they/their)</option>
      </select>

      <button id="generateBtn" class="btn btn-primary">Generate & Download PDF</button>
    </div>

    <!-- Right: preview -->
    <div class="preview-frame">
      <div class="page" id="page">
        <div class="meta" id="metaDate">10 September 2025</div>

        <div class="to">
          To,<br>
          Rtn. <span class="recipient" id="previewMember">Rajneesh Parek</span>,
        </div>

        <div class="body-paragraph" id="para1">
          We extend our deepest condolences on the passing of your <span id="previewRelation">mother</span> <span id="previewDeceased">Madhubala Pareek</span> for the untimely loss of <span id="pronObj">her</span> life. Losing a family member is always difficult to face.
        </div>

        <div class="body-paragraph" id="para2">
          In this tough period of your life's journey, we are committed to being there for you. In light of the loss of your <span id="repeatRelation">mother</span>, we are sympathetic to your efforts to move forward with your life's work.
        </div>

        <div class="body-paragraph" id="para3">
          <span id="pronSubj">She</span> will always be remembered with great admiration. May God give strength to you & your family during this difficult time.
        </div>

        <div class="signatures">
          <div class="sig-block">
            Warm Regards,<br><br>
            Rtn. Rajesh Kumar Narula<br>
            <span class="sig-title">(President)</span>
          </div>
          <div class="sig-block" style="text-align:right">
            Rtn. Dr. D.S. Rathore<br>
            <span class="sig-title">(Secretary)</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- html2pdf -->
  <script src="https://unpkg.com/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
  <script>
    function readableToday(){
      const d=new Date();
      return d.toLocaleDateString(undefined,{day:'2-digit',month:'long',year:'numeric'});
    }

    const dateEl=document.getElementById('date'),
          memberEl=document.getElementById('member'),
          deceasedEl=document.getElementById('deceased'),
          relationEl=document.getElementById('relation'),
          genderEl=document.getElementById('gender');

    const metaDate=document.getElementById('metaDate'),
          prevMember=document.getElementById('previewMember'),
          prevDeceased=document.getElementById('previewDeceased'),
          prevRelation=document.getElementById('previewRelation'),
          repeatRelation=document.getElementById('repeatRelation'),
          pronObj=document.getElementById('pronObj'),
          pronSubj=document.getElementById('pronSubj');

    const PR={
      male:{obj:'his',subj:'He'},
      female:{obj:'her',subj:'She'},
      other:{obj:'their',subj:'They'}
    };

    function updatePreview(){
      metaDate.textContent=dateEl.value.trim()||readableToday();
      prevMember.textContent=memberEl.value.trim()||'—';
      prevDeceased.textContent=deceasedEl.value.trim()||'—';
      prevRelation.textContent=relationEl.value.trim()||'—';
      repeatRelation.textContent=relationEl.value.trim()||'—';
      const g=PR[genderEl.value]||PR.other;
      pronObj.textContent=g.obj;
      pronSubj.textContent=g.subj;
    }

    [dateEl,memberEl,deceasedEl,relationEl,genderEl].forEach(el=>{
      el.addEventListener('input',updatePreview);
      el.addEventListener('change',updatePreview);
    });

    document.getElementById('generateBtn').addEventListener('click',()=>{
      updatePreview();
      const element=document.getElementById('page');
      const opt={
        margin:[25.4,25.4,25.4,25.4], // top,right,bottom,left in mm
        filename:`condolence_${(deceasedEl.value||'deceased').replace(/\s+/g,'_')}.pdf`,
        image:{type:'jpeg',quality:0.98},
        html2canvas:{scale:2},
        jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
      };
      html2pdf().set(opt).from(element).save();
    });

    document.addEventListener('DOMContentLoaded',updatePreview);
  </script>
</body>
</html>
